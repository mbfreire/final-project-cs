# Credit Card Fraud Detection with IntroVAE and XGBoost

This repository presents a novel approach to detecting credit card fraud by leveraging the power of self-adversarial variational autoencoder with elliptic envelope for unsupervised anomaly detection, complemented by a supervised XGBoost model for classification. Our methodology combines the strengths of unsupervised learning for feature extraction and anomaly detection with the precision of supervised learning for fraud classification.

In particular, the choice of XGBoost as our supervised learning model is motivated by its excellent performance on structured data and its inherent interpretability. Unlike many black-box models, XGBoost provides valuable insights into feature importance directly, making it a preferred choice for sensitive applications like fraud detection where understanding the rationale behind predictions is crucial.

## Enhancing Model Interpretability with LIME and SHAP

To further demystify the model's decision-making process and ensure transparency, we integrate LIME (Local Interpretable Model-agnostic Explanations) and SHAP (SHapley Additive exPlanations) into our evaluation workflow. These tools offer a window into the model's reasoning at both the global and local levels:

## Project Overview

Credit card fraud detection poses a significant challenge due to the imbalanced nature of transaction datasets and the sophisticated tactics employed by fraudsters. This project aims to address these challenges by:
- Utilizing IntroVAE models to identify anomalous transactions as potential fraud.
- Generating pseudo labels based on anomaly detection to train a robust XGBoost classifier.
- Evaluating model performance with comprehensive metrics, including Precision, Recall, F1 Score, PR AUC, and ROC AUC.

## Installation

To set up the project environment, install the required dependencies:
pip install -r requirements.txt

## Usage

### Data Preparation

Download the dataset from https://www.kaggle.com/datasets/mlg-ulb/creditcardfraud. Place your credit card transaction dataset in the `dataset/` directory, name it as fraud_credit.zip.

### Model Training

To train the SAVAE-EE model:

```python
python main.py
```

To train the XGBoost model using pseudo labels generated by SAVAE-EE:

```python
python main-supervised.py
```

### Evaluation

To evaluate the models and visualize their performance:
```python
streamlit run app.py
```


## Features

- **IntroVAE for Anomaly Detection**: Detects potential fraudulent transactions without needing labeled data.
- **XGBoost Classifier**: Utilizes pseudo labels for precise fraud classification.
- **Model Visualization**: Use Netron for an interactive overview of the trained model architecture.
- **Comprehensive Evaluation**: Includes various metrics to assess the models' performance thoroughly.
